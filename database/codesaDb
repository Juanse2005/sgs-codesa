-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


ALTER TABLE IF EXISTS public.administrativo DROP CONSTRAINT IF EXISTS fk2k8ahh7en8185kkm7ej8sua5w;

ALTER TABLE IF EXISTS public.curso DROP CONSTRAINT IF EXISTS fkenvwioi79avb9nl1xnw8n3hao;

ALTER TABLE IF EXISTS public.estudiante DROP CONSTRAINT IF EXISTS fkhffieau25rgbm9yn18j9d68ba;

ALTER TABLE IF EXISTS public.inscripcion DROP CONSTRAINT IF EXISTS fk6sw931ij561k2fq5sx4xonmlr;

ALTER TABLE IF EXISTS public.inscripcion DROP CONSTRAINT IF EXISTS fk8hgaf3r1wwea199gneh6m8035;

ALTER TABLE IF EXISTS public.profesor DROP CONSTRAINT IF EXISTS fk6k2r09hwpk5gt13kd3vye4ncf;

ALTER TABLE IF EXISTS public.usuario DROP CONSTRAINT IF EXISTS fkagix3q8yqktlyj3yp1sn0mcd9;



DROP TABLE IF EXISTS public.administrativo;

CREATE TABLE IF NOT EXISTS public.administrativo
(
    id_persona bigint NOT NULL,
    cargo character varying(255) COLLATE pg_catalog."default" NOT NULL,
    departamento character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT administrativo_pkey PRIMARY KEY (id_persona)
);

DROP TABLE IF EXISTS public.curso;

CREATE TABLE IF NOT EXISTS public.curso
(
    id_curso bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    creditos integer,
    descripcion character varying(255) COLLATE pg_catalog."default" NOT NULL,
    nombre_curso character varying(255) COLLATE pg_catalog."default" NOT NULL,
    id_profesor bigint NOT NULL,
    CONSTRAINT curso_pkey PRIMARY KEY (id_curso)
);

DROP TABLE IF EXISTS public.estudiante;

CREATE TABLE IF NOT EXISTS public.estudiante
(
    id_persona bigint NOT NULL,
    grado character varying(255) COLLATE pg_catalog."default" NOT NULL,
    numero_matricula character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT estudiante_pkey PRIMARY KEY (id_persona),
    CONSTRAINT uknxwg5kyigirv4nsc5vcwvixvy UNIQUE (numero_matricula)
);

DROP TABLE IF EXISTS public.inscripcion;

CREATE TABLE IF NOT EXISTS public.inscripcion
(
    id_inscripcion bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    fecha_inscripcion date NOT NULL,
    id_curso bigint NOT NULL,
    id_estudiante bigint NOT NULL,
    CONSTRAINT inscripcion_pkey PRIMARY KEY (id_inscripcion)
);

DROP TABLE IF EXISTS public.persona;

CREATE TABLE IF NOT EXISTS public.persona
(
    id_persona bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    apellido character varying(255) COLLATE pg_catalog."default" NOT NULL,
    email character varying(255) COLLATE pg_catalog."default" NOT NULL,
    fecha_nacimiento date NOT NULL,
    nombre character varying(255) COLLATE pg_catalog."default" NOT NULL,
    password character varying(255) COLLATE pg_catalog."default" NOT NULL,
    telefono character varying(255) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT persona_pkey PRIMARY KEY (id_persona),
    CONSTRAINT ukbfxfxg15pmy0c1imvi6ucoeem UNIQUE (email)
);

DROP TABLE IF EXISTS public.profesor;

CREATE TABLE IF NOT EXISTS public.profesor
(
    id_persona bigint NOT NULL,
    especialidad character varying(255) COLLATE pg_catalog."default" NOT NULL,
    fecha_contratacion date NOT NULL,
    CONSTRAINT profesor_pkey PRIMARY KEY (id_persona)
);

DROP TABLE IF EXISTS public.usuario;

CREATE TABLE IF NOT EXISTS public.usuario
(
    id_usuario bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    rol character varying(255) COLLATE pg_catalog."default" NOT NULL,
    id_persona bigint NOT NULL,
    CONSTRAINT usuario_pkey PRIMARY KEY (id_usuario)
);

ALTER TABLE IF EXISTS public.administrativo
    ADD CONSTRAINT fk2k8ahh7en8185kkm7ej8sua5w FOREIGN KEY (id_persona)
    REFERENCES public.persona (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS administrativo_pkey
    ON public.administrativo(id_persona);


ALTER TABLE IF EXISTS public.curso
    ADD CONSTRAINT fkenvwioi79avb9nl1xnw8n3hao FOREIGN KEY (id_profesor)
    REFERENCES public.profesor (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.estudiante
    ADD CONSTRAINT fkhffieau25rgbm9yn18j9d68ba FOREIGN KEY (id_persona)
    REFERENCES public.persona (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS estudiante_pkey
    ON public.estudiante(id_persona);


ALTER TABLE IF EXISTS public.inscripcion
    ADD CONSTRAINT fk6sw931ij561k2fq5sx4xonmlr FOREIGN KEY (id_curso)
    REFERENCES public.curso (id_curso) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.inscripcion
    ADD CONSTRAINT fk8hgaf3r1wwea199gneh6m8035 FOREIGN KEY (id_estudiante)
    REFERENCES public.estudiante (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.profesor
    ADD CONSTRAINT fk6k2r09hwpk5gt13kd3vye4ncf FOREIGN KEY (id_persona)
    REFERENCES public.persona (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS profesor_pkey
    ON public.profesor(id_persona);


ALTER TABLE IF EXISTS public.usuario
    ADD CONSTRAINT fkagix3q8yqktlyj3yp1sn0mcd9 FOREIGN KEY (id_persona)
    REFERENCES public.persona (id_persona) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;